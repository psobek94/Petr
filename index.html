<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Moje investi캜n칤 portfolio</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #0d1117;
      color: #ddd;
    }
    header {
      background: linear-gradient(to right, #0d1117, #1a1f2c);
      padding: 1rem;
      text-align: center;
    }
    header h1 {
      margin: 0;
    }
    nav {
      display: flex;
      justify-content: center;
      gap: 1rem;
      background-color: #161b22;
      padding: 0.5rem;
    }
    nav a {
      color: #ddd;
      text-decoration: none;
      font-weight: 600;
      padding: 0.3rem 0.6rem;
      border-radius: 5px;
    }
    nav a:hover {
      background-color: #30363d;
    }
    .container {
      padding: 1rem;
      max-width: 1200px;
      margin: 0 auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      border: 1px solid #30363d;
      padding: 0.5rem;
      text-align: left;
    }
    th {
      background-color: #21262d;
    }
    select, input[type="text"], input[type="number"], input[type="date"], select, button {
      background-color: #161b22;
      color: #ddd;
      border: 1px solid #30363d;
      padding: 0.3rem;
      margin: 0.3rem;
    }
    button {
      cursor: pointer;
    }
    section { display: none; }
    section.active { display: block; }
  </style>
</head>
<body>
  <header>
    <h1>Moje investi캜n칤 portfolio</h1>
  </header>

  <nav>
    <a href="#" onclick="showSection('dashboard')">Dashboard</a>
    <a href="#" onclick="showSection('calendar')">Dividendov칳 kalend치콏</a>
    <a href="#" onclick="showSection('performance')">V칳konnost</a>
    <a href="#" onclick="showSection('dividends')">Dividendy</a>
    <a href="#" onclick="showSection('diversification')">Diversifikace</a>
    <a href="#" onclick="showSection('transactions')">Transakce</a>
  </nav>

  <section id="dashboard" class="container active">
    <!-- P콢vodn칤 dashboard sekce -->
    <label for="currency">M캩na:</label>
    <select id="currency">
      <option value="USD">USD</option>
      <option value="CZK">CZK</option>
    </select>

    <input type="text" id="search" placeholder="Hledat akcie..." style="float:right;"/>

    <table id="portfolio">
      <thead>
        <tr>
          <th>Logo</th>
          <th>N치zev</th>
          <th>Ticker</th>
          <th>Po캜et</th>
          <th>Cena (USD)</th>
          <th>Hodnota</th>
          <th>Div. v칳nos</th>
          <th>Dividenda ro캜n캩</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><img src="https://logo.clearbit.com/apple.com" alt="Apple" width="32" /></td>
          <td>Apple</td>
          <td>AAPL</td>
          <td>5</td>
          <td>180</td>
          <td class="value" data-usd="900">900</td>
          <td>0.5%</td>
          <td>4.5</td>
        </tr>
        <tr>
          <td><img src="https://logo.clearbit.com/microsoft.com" alt="Microsoft" width="32" /></td>
          <td>Microsoft</td>
          <td>MSFT</td>
          <td>3</td>
          <td>350</td>
          <td class="value" data-usd="1050">1050</td>
          <td>0.8%</td>
          <td>8.4</td>
        </tr>
      </tbody>
    </table>
  </section>

  <section id="calendar" class="container">
    <h2>游늰 Dividendov칳 kalend치콏</h2>
    <label for="monthSelect">Zobrazit m캩s칤c:</label>
    <select id="monthSelect">
      <option value="all">V코e</option>
      <option value="2025-07">캛ervenec 2025</option>
      <option value="2025-08">Srpen 2025</option>
    </select>

    <table id="dividendTable">
      <thead>
        <tr>
          <th>Ticker</th>
          <th>N치zev</th>
          <th>Ex-div date</th>
          <th>Payment date</th>
          <th>캛치stka (USD)</th>
          <th>Frekvence</th>
        </tr>
      </thead>
      <tbody>
        <tr data-month="2025-07">
          <td>BTI</td>
          <td>British American Tobacco</td>
          <td>2025-07-10</td>
          <td>2025-08-04</td>
          <td>0.73</td>
          <td>Kvart치ln캩</td>
        </tr>
        <tr data-month="2025-08">
          <td>O</td>
          <td>Realty Income</td>
          <td>2025-08-15</td>
          <td>2025-09-01</td>
          <td>0.25</td>
          <td>M캩s칤캜n캩</td>
        </tr>
      </tbody>
    </table>

    <canvas id="dividendChart" style="margin-top:2rem;"></canvas>
  </section>

  <section id="performance" class="container">
    <h2>游늵 Srovn치n칤 s indexem S&P 500</h2>
    <canvas id="performanceChart"></canvas>
  </section>

  <section id="transactions" class="container">
    <h2>游 Transakce</h2>

    <form id="transactionForm">
      <input type="text" id="ticker" placeholder="Ticker (nap콏. AAPL)" required />
      <input type="number" id="quantity" placeholder="Po캜et" required />
      <input type="number" step="0.01" id="price" placeholder="Cena za kus" required />
      <input type="date" id="date" required />
      <select id="type" required>
        <option value="buy">N치kup</option>
        <option value="sell">Prodej</option>
      </select>
      <button type="submit">P콏idat transakci</button>
    </form>

    <table id="transactionTable">
      <thead>
        <tr>
          <th>Ticker</th>
          <th>Po캜et</th>
          <th>Cena n치kupu</th>
          <th>Typ</th>
          <th>Datum</th>
          <th>Aktu치ln칤 cena</th>
          <th>Zisk/Ztr치ta</th>
          <th>%</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    function showSection(id) {
      document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    const currencySelect = document.getElementById("currency");
    const values = document.querySelectorAll(".value");
    const exchangeRate = 23.5;

    currencySelect.addEventListener("change", () => {
      const currency = currencySelect.value;
      values.forEach(cell => {
        const usd = parseFloat(cell.dataset.usd);
        cell.textContent = currency === "CZK" ? (usd * exchangeRate).toFixed(2) : usd.toFixed(2);
      });
    });

    const searchInput = document.getElementById("search");
    searchInput.addEventListener("input", () => {
      const filter = searchInput.value.toLowerCase();
      const rows = document.querySelectorAll("#portfolio tbody tr");
      rows.forEach(row => {
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(filter) ? "" : "none";
      });
    });

    const monthSelect = document.getElementById("monthSelect");
    monthSelect.addEventListener("change", () => {
      const selected = monthSelect.value;
      document.querySelectorAll("#dividendTable tbody tr").forEach(row => {
        row.style.display = (selected === "all" || row.dataset.month === selected) ? "" : "none";
      });
    });

    const ctxDiv = document.getElementById("dividendChart").getContext("2d");
    new Chart(ctxDiv, {
      type: "bar",
      data: {
        labels: ["2025-05", "2025-06", "2025-07", "2025-08", "2025-09"],
        datasets: [{
          label: "Vyplacen칠 dividendy (USD)",
          data: [6.25, 12.5, 18.75, 22.0, 25.4],
          backgroundColor: "rgba(0, 153, 255, 0.8)",
          borderColor: "rgba(0, 153, 255, 1)",
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        plugins: { legend: { display: false } },
        scales: {
          x: { ticks: { color: "#ddd" }, grid: { color: "rgba(255,255,255,0.1)" } },
          y: { ticks: { color: "#ddd" }, grid: { color: "rgba(255,255,255,0.1)" }, beginAtZero: true }
        }
      }
    });

    const ctxPerf = document.getElementById("performanceChart").getContext("2d");
    new Chart(ctxPerf, {
      type: "line",
      data: {
        labels: ["2025-03", "2025-04", "2025-05", "2025-06", "2025-07"],
        datasets: [
          {
            label: "Moje portfolio",
            data: [0, 2.3, 4.8, 7.1, 9.4],
            borderColor: "#00ccff",
            backgroundColor: "transparent",
            tension: 0.4
          },
          {
            label: "S&P 500",
            data: [0, 1.1, 2.7, 3.5, 4.9],
            borderColor: "#999",
            backgroundColor: "transparent",
            borderDash: [5, 5],
            tension: 0.4
          }
        ]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { labels: { color: "#ccc" } },
          tooltip: {
            backgroundColor: "#222",
            titleColor: "#fff",
            bodyColor: "#fff"
          }
        },
        scales: {
          x: {
            ticks: { color: "#ddd" },
            grid: { color: "rgba(255,255,255,0.05)" }
          },
          y: {
            ticks: { color: "#ddd" },
            grid: { color: "rgba(255,255,255,0.05)" },
            beginAtZero: true
          }
        }
      }
    });

    const transactionForm = document.getElementById("transactionForm");
    const transactionTable = document.querySelector("#transactionTable tbody");
    let transactions = JSON.parse(localStorage.getItem("transactions") || "[]");

    async function fetchCurrentPrice(ticker) {
      try {
        const response = await fetch(`https://query1.finance.yahoo.com/v7/finance/quote?symbols=${ticker}`);
        const data = await response.json();
        return data.quoteResponse.result[0]?.regularMarketPrice || 0;
      } catch (e) {
        return 0;
      }
    }

    function renderTransactions() {
      transactionTable.innerHTML = "";
      transactions.forEach(async (tx, index) => {
        const currentPrice = await fetchCurrentPrice(tx.ticker);
        const diff = currentPrice - tx.price;
        const diffPercent = ((diff / tx.price) * 100).toFixed(2);
        const profit = (diff * tx.quantity).toFixed(2);
        const color = diff >= 0 ? "#4caf50" : "#e53935";

        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${tx.ticker}</td>
          <td>${tx.quantity}</td>
          <td>${tx.price}</td>
          <td>${tx.type}</td>
          <td>${tx.date}</td>
          <td>${currentPrice.toFixed(2)}</td>
          <td style="color:${color}">${profit}</td>
          <td style="color:${color}">${diffPercent}%</td>
        `;
        transactionTable.appendChild(row);
      });
    }

    transactionForm.addEventListener("submit", e => {
      e.preventDefault();
      const newTx = {
        ticker: document.getElementById("ticker").value.toUpperCase(),
        quantity: parseFloat(document.getElementById("quantity").value),
        price: parseFloat(document.getElementById("price").value),
        date: document.getElementById("date").value,
        type: document.getElementById("type").value
      };
      transactions.push(newTx);
      localStorage.setItem("transactions", JSON.stringify(transactions));
      renderTransactions();
      transactionForm.reset();
    });

    renderTransactions();
  </script>
</body>
</html>

